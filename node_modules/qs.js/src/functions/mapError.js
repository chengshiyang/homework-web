import {createStreamConstructor, createPropertyConstructor} from './common';



const mixin = {
    init({fn}) {
        this._fn = fn;
    },

    _free() {
        this._fn = null;
    },

    _handleError(e) {
        this.emitError(this._fn(e));
    }
};

const MapErrorStream = createStreamConstructor('mapError', mixin);
const MapErrorProperty = createPropertyConstructor('mapError', mixin);

function mapError(source, fn) {
    return new (source._ofSameType(MapErrorStream, MapErrorProperty))(source, {fn});
}



export default mapError;
