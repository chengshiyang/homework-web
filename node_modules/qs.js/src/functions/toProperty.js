import {createPropertyConstructor} from './common';
import {M_NULL} from '../constants/common';


const mixin = {
    init({fn}) {
        this._getInitialValue = fn;
    },

    _onActivation() {
        if (this._getInitialValue !== null) {
            this.emitValue(this._getInitialValue());
        }
        this._source.onAny(this._$handleAny);
    }
};

const P = createPropertyConstructor('toProperty', mixin);

module.exports = function toProperty(ob, fn = null) {
    return new P(ob, {fn});
};
